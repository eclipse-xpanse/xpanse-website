"use strict";(self.webpackChunkosc_website=self.webpackChunkosc_website||[]).push([[185],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>k});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(t),d=r,k=c["".concat(s,".").concat(d)]||c[d]||m[d]||l;return t?a.createElement(k,o(o({ref:n},u),{},{components:t})):a.createElement(k,o({ref:n},u))}));function k(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[c]="string"==typeof e?e:r,o[1]=i;for(var p=2;p<l;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},4456:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var a=t(7462),r=(t(7294),t(3905));const l={sidebar_position:4},o="Runtime",i={unversionedId:"runtime",id:"runtime",title:"Runtime",description:"Open Services Cloud runtime is the running module. It packages and executes all together: OCL loader, orchestrator,",source:"@site/docs/runtime.md",sourceDirName:".",slug:"/runtime",permalink:"/xpanse-website/docs/runtime",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Configuration Language",permalink:"/xpanse-website/docs/ocl"},next:{title:"REST API",permalink:"/xpanse-website/docs/api"}},s={},p=[{value:"Build",id:"build",level:2},{value:"Run",id:"run",level:3},{value:"Docker",id:"docker",level:3},{value:"Kubernetes",id:"kubernetes",level:3}],u={toc:p},c="wrapper";function m(e){let{components:n,...t}=e;return(0,r.kt)(c,(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"runtime"},"Runtime"),(0,r.kt)("p",null,"Open Services Cloud runtime is the running module. It packages and executes all together: OCL loader, orchestrator,\nplugins, REST API, ..."),(0,r.kt)("h2",{id:"build"},"Build"),(0,r.kt)("p",null,"You can easily build Xpanse yourself."),(0,r.kt)("p",null,"As requirement, you need:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"a Java Developer Kit (JDK) installed, version 17 or newer. You can use ",(0,r.kt)("a",{parentName:"li",href:"https://openjdk.org/"},"openjdk"),"\nor ",(0,r.kt)("a",{parentName:"li",href:"https://adoptium.net/"},"temurin")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://maven.apache.org/"},"Apache Maven 3.8.x or newer"))),(0,r.kt)("p",null,"You can clone the project locally on your machine with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ git clone https://github.com/eclipse-xpanse/xpanse\n$ cd xpanse\n")),(0,r.kt)("p",null,"First, you can build the whole xpanse project, including all modules (orchestrator, OCL, runtime, plugins, etc), simply\nwith:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ mvn clean install\n")),(0,r.kt)("h3",{id:"run"},"Run"),(0,r.kt)("p",null,"By default, the application will not activate any plugins. They must be activated via spring profiles. Also ensure that\nonly one plugin is active at a time."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"for Huawei Cloud:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ cd runtime/target\n$ java -jar xpanse-runtime-1.0.0-SNAPSHOT.jar -Dspring.profiles.active=huaweicloud\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"for Openstack:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ cd runtime/target\n$ java -jar xpanse-runtime-1.0.0-SNAPSHOT.jar -Dspring.profiles.active=openstack\n")),(0,r.kt)("p",null,'By default, the runtime is built in "exploded mode". Additionally, you can also build a Docker image\nadding ',(0,r.kt)("inlineCode",{parentName:"p"},"-Ddocker.skip=false")," as build argument:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ cd runtime\n$ mvn clean install -Ddocker.skip=false\n")),(0,r.kt)("p",null,"We can start xpanse runtime with a specific plugin by passing the plugin name in the profile name. For example to start\nhuaweicloud"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'$ docker run -e "SPRING_PROFILES_ACTIVE=huaweicloud" --name my-xpanse-runtime osc\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'\nYou can see the log messages:\n\n```shell\n   _  __   ____    ____ _   ____    _____  ___\n  | |/_/  / __ \\  / __ `/  / __ \\  / ___/ / _ \\\n _>  <   / /_/ / / /_/ /  / / / / (__  ) /  __/\n/_/|_|  / .___/  \\__,_/  /_/ /_/ /____/  \\___/\n       /_/\n\n        xpanse 1.0.0-SNAPSHOT (2023)\n13:44:19.633 [main] INFO  o.e.xpanse.runtime.XpanseApplication - Starting XpanseApplication using Java 17.0.5 with PID 7344\n13:44:19.645 [main] INFO  o.e.xpanse.runtime.XpanseApplication - No active profile set, falling back to 1 default profile: "default"\n13:44:22.211 [main] INFO  o.e.x.o.FileOrchestratorStorage - No other storage beans found. Using default file storage.\n13:44:23.878 [main] WARN  o.e.x.o.OrchestratorService - No xpanse plugins loaded by the runtime.\n13:44:23.886 [main] INFO  o.e.xpanse.runtime.XpanseApplication - Started XpanseApplication in 5.029 seconds (process running for 5.992)\n\n')),(0,r.kt)("p",null,"The Xpanse REST API is now available. You can check the status of the runtime by calling the health endpoint on the REST\nAPI:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ curl -XGET http://localhost:8080/xpanse/health\nready\n")),(0,r.kt)("h3",{id:"docker"},"Docker"),(0,r.kt)("p",null,"If you use ",(0,r.kt)("inlineCode",{parentName:"p"},"-Ddocker.skip=false")," as option on the build command line, you have docker image ready for the runtime."),(0,r.kt)("p",null,"You can see the docker images created:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ docker images|grep xpanse\nxpanse                   1.0.0-SNAPSHOT   4b716096304b   15 seconds ago   293MB\nxpanse                   latest           4b716096304b   15 seconds ago   293MB\n")),(0,r.kt)("p",null,"You can run a docker container with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'$ docker run -d --name my-xpanse -p 8080:8080 xpanse\n$ docker logs my-xpanse\n...\n   _  __   ____    ____ _   ____    _____  ___\n  | |/_/  / __ \\  / __ `/  / __ \\  / ___/ / _ \\\n _>  <   / /_/ / / /_/ /  / / / / (__  ) /  __/\n/_/|_|  / .___/  \\__,_/  /_/ /_/ /____/  \\___/\n       /_/\n\n        xpanse 1.0.0-SNAPSHOT (2023)\n13:44:19.633 [main] INFO  o.e.xpanse.runtime.XpanseApplication - Starting XpanseApplication using Java 17.0.5 with PID 7344\n13:44:19.645 [main] INFO  o.e.xpanse.runtime.XpanseApplication - No active profile set, falling back to 1 default profile: "default"\n13:44:22.211 [main] INFO  o.e.x.o.FileOrchestratorStorage - No other storage beans found. Using default file storage.\n13:44:23.878 [main] WARN  o.e.x.o.OrchestratorService - No xpanse plugins loaded by the runtime.\n13:44:23.886 [main] INFO  o.e.xpanse.runtime.XpanseApplication - Started XpanseApplication in 5.029 seconds (process running for 5.992)\n')),(0,r.kt)("p",null,"The OSC REST API is now available. You can check the status of the runtime by calling the health endpoint on the REST\nAPI:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ curl -XGET http://localhost:8080/xpanse/health\nready\n")),(0,r.kt)("h3",{id:"kubernetes"},"Kubernetes"),(0,r.kt)("p",null,"OSC provides all Kubernetes manifest files in the ",(0,r.kt)("inlineCode",{parentName:"p"},"runtime/src/main/kubernetes")," folder, allowing you to deploy all\nresources on your Kubernetes cluster."),(0,r.kt)("p",null,"As example, you can deploy on local ",(0,r.kt)("inlineCode",{parentName:"p"},"minikube")," instance. First, start your ",(0,r.kt)("inlineCode",{parentName:"p"},"minikube")," instance:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ minikube start\n$ eval $(minikube -p minikube docker-env)\n")),(0,r.kt)("p",null,"First, you create the ",(0,r.kt)("inlineCode",{parentName:"p"},"osc")," namespace in Kubernetes:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl apply -f runtime/src/main/kubernetes/org.eclipse.osc.namespace.yaml\nnamespace/osc created\n")),(0,r.kt)("p",null,"You can now create the OSC runtime deployment in Kubernetes:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl apply -f runtime/src/main/kubernetes/org.eclipse.osc.deployment.k8s.yaml \ndeployment.apps/osc created\n")),(0,r.kt)("p",null,"You can check the status of the deployment:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get deployments -n xpanse\nNAME   READY   UP-TO-DATE   AVAILABLE   AGE\nxpanse    1/1     1            1           20s\n")),(0,r.kt)("p",null,"and the associated pod running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get pods -n xpanse\nNAME                   READY   STATUS    RESTARTS   AGE\nosc-8699fd7547-vj44p   1/1     Running   0          42s\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"\nWe can now deploy the service exposing the port 8080 of the OSC runtime:\n\n```shell\n$ kubectl apply -f runtime/src/main/kubernetes/org.eclipse.osc.service.yaml \nservice/xpanse created\n")),(0,r.kt)("p",null,"and check that the port is currently bound on the NodePort:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get services -n xpanse\nNAME   TYPE       CLUSTER-IP    EXTERNAL-IP   PORT(S)          AGE\nosc    NodePort   10.97.81.86   <none>        8080:32228/TCP   13s\n")),(0,r.kt)("p",null,"We can now access the health endpoint of the OSC REST API:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ minikube service list -n xpanse\n|-----------|------|-------------|---------------------------|\n| NAMESPACE | NAME | TARGET PORT |            URL            |\n|-----------|------|-------------|---------------------------|\n| osc       | osc  |        8080 | http://192.168.49.2:32228 |\n|-----------|------|-------------|---------------------------|\n")),(0,r.kt)("p",null,"You can now point test the health endpoint:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ curl -XGET http://192.168.49.2:32228/xpanse/health\nready\n")),(0,r.kt)("p",null,"Xpanse is now ready on your Kubernetes cluster."))}m.isMDXComponent=!0}}]);